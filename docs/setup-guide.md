# RoboTable Setup Guide

Complete guide for deploying RoboTable for your team.

---

## Table of Contents

1. [Local Testing](#local-testing)
2. [Supabase Integration](#supabase-integration)
3. [Render Deployment](#render-deployment)
4. [Team Setup](#team-setup)
5. [Troubleshooting](#troubleshooting)

---

## Local Testing

### Prerequisites

- Docker Desktop installed and running
- 2GB free disk space

### Step 1: Launch RoboTable

```bash
cd RoboTable
docker-compose up -d
```

### Step 2: Access the Interface

Open browser: http://localhost:8080

### Step 3: Create Admin Account

1. Click "Sign Up"
2. Enter email and password
3. Create your first workspace

### Step 4: Test Core Features

Create test tables for your use cases:

**CRM Table**:
- Fields: Customer Name, Email, Phone, Status, Deal Value
- Create kanban view grouped by Status

**Project Management Table**:
- Fields: Task, Assignee, Status, Due Date, Priority
- Create kanban view grouped by Status

**Content Calendar Table**:
- Fields: Title, Author, Publish Date, Status, Platform
- Create calendar view based on Publish Date

**Inventory Table**:
- Fields: Item Name, SKU, Quantity, Location, Reorder Point
- Add filter: Quantity < Reorder Point

### Success Criteria

- [ ] Can create tables and add data
- [ ] Views (grid, kanban, gallery) work correctly
- [ ] Can create relations between tables
- [ ] Filters and sorts function properly
- [ ] Can invite test users and assign roles

**Time**: 1-2 hours
**Next**: If everything works, proceed to Supabase integration

---

## Supabase Integration

### Why Supabase?

- Production-grade PostgreSQL
- Automatic backups (7-day retention)
- Connection pooling built-in
- Scales to thousands of users
- Better performance than SQLite

### Step 1: Get Supabase Connection String

1. Log in to https://supabase.com
2. Navigate to your project (or create new project)
3. Go to: **Settings** → **Database**
4. Find "Connection String" section
5. Copy the URI format:
   ```
   postgresql://postgres:[YOUR-PASSWORD]@db.[PROJECT-REF].supabase.co:5432/postgres
   ```
6. Replace `[YOUR-PASSWORD]` with your actual password

### Step 2: Convert to NocoDB Format

NocoDB uses a slightly different format:

```
pg://db.[PROJECT-REF].supabase.co:5432?u=postgres&p=[YOUR-PASSWORD]&d=postgres
```

**Example**:
- Supabase format: `postgresql://postgres:mypass123@db.abc123.supabase.co:5432/postgres`
- NocoDB format: `pg://db.abc123.supabase.co:5432?u=postgres&p=mypass123&d=postgres`

### Step 3: Create .env File

```bash
cd RoboTable
cp .env.example .env
```

Edit `.env`:
```env
NC_DB=pg://db.your-ref.supabase.co:5432?u=postgres&p=your-password&d=postgres
NC_AUTH_JWT_SECRET=your-random-secret-here
NC_PUBLIC_URL=http://localhost:8080
NC_DISABLE_TELE=true
```

**Generate JWT Secret**:
```bash
# On Mac/Linux
openssl rand -hex 32

# Or use online generator
# https://www.random.org/strings/
```

### Step 4: Launch with Supabase

```bash
# Stop local SQLite instance
docker-compose down

# Start with Supabase
docker-compose --env-file .env up -d

# View logs to verify connection
docker-compose logs -f
```

### Step 5: Verify in Supabase

1. Open Supabase Dashboard
2. Go to **Table Editor**
3. You should see new tables created by NocoDB:
   - `nc_evolutions`
   - `nc_projects`
   - `nc_models`
   - etc.

### Step 6: Test Data Persistence

1. Create a table in RoboTable
2. Add some test data
3. Stop Docker: `docker-compose down`
4. Start Docker: `docker-compose up -d`
5. Verify data is still there

**Success**: Data persists across restarts and is visible in Supabase dashboard

**Time**: 30-60 minutes

---

## Render Deployment

### Step 1: Prepare Repository

```bash
cd RoboTable

# Initialize git (if not already)
git init

# Add all files
git add .

# Commit
git commit -m "Initial RoboTable setup"
```

### Step 2: Push to GitHub

```bash
# Create repo on GitHub: https://github.com/new

# Add remote
git remote add origin https://github.com/yourusername/robotable.git

# Push
git branch -M main
git push -u origin main
```

### Step 3: Connect to Render

1. Go to https://dashboard.render.com
2. Click **"New +"** → **"Blueprint"**
3. Connect your GitHub account (if not connected)
4. Select your `robotable` repository
5. Render will detect `render.yaml` automatically
6. Click **"Apply"**

### Step 4: Configure Environment Variables

Render will create the service. Now set environment variables:

1. Click on your **"robotable"** service
2. Go to **"Environment"** tab
3. Add/Edit variables:

```
NC_DB = pg://db.your-ref.supabase.co:5432?u=postgres&p=password&d=postgres
NC_AUTH_JWT_SECRET = [auto-generated by Render]
NC_PUBLIC_URL = https://robotable.onrender.com
NC_DISABLE_TELE = true
PORT = 8080
```

**Important**:
- `NC_DB`: Use your Supabase connection string
- `NC_AUTH_JWT_SECRET`: Already generated by Render (check existing value)
- `NC_PUBLIC_URL`: Update to your actual Render URL

### Step 5: Deploy

1. Click **"Manual Deploy"** → **"Deploy latest commit"**
2. Wait 3-5 minutes for build and deployment
3. Watch logs for any errors

### Step 6: Verify Deployment

1. Open your Render URL: `https://robotable.onrender.com`
2. Create admin account
3. Test basic functionality

### Step 7: Custom Domain (Optional)

1. In Render dashboard, go to **"Settings"** → **"Custom Domain"**
2. Click **"Add Custom Domain"**
3. Enter your domain: `robotable.yourcompany.com`
4. Follow DNS setup instructions
5. Update `NC_PUBLIC_URL` environment variable
6. Redeploy

**Time**: 1-2 hours
**Cost**: $7/month (Starter plan)

---

## Team Setup

### Inviting Users

1. Log in to RoboTable as admin
2. Open workspace
3. Click **"Invite"** button
4. Enter team member email
5. Select role:
   - **Creator**: Full admin access
   - **Editor**: Can edit all data
   - **Commenter**: Can view and comment
   - **Viewer**: Read-only

### Creating Workspaces

**Best Practice**: Separate workspace for each use case

1. **CRM Workspace**
   - Tables: Customers, Deals, Interactions, Products
   - Views: Pipeline (kanban), All Customers (grid), Analytics (gallery)

2. **Projects Workspace**
   - Tables: Projects, Tasks, Milestones, Team Members
   - Views: Active Tasks (kanban), Timeline (calendar), All Projects (grid)

3. **Content Workspace**
   - Tables: Content Items, Authors, Platforms, Categories
   - Views: Editorial Calendar (calendar), Production (kanban), Published (gallery)

4. **Inventory Workspace**
   - Tables: Items, Locations, Suppliers, Purchase Orders
   - Views: Current Stock (grid), Low Stock (filtered grid), By Location (grouped)

### Permission Strategy

| Role | Who | What They Can Do |
|------|-----|------------------|
| **Creator** | Leadership, IT | Everything - manage workspace, users, integrations |
| **Editor** | Most team members | Create/edit/delete data, create views |
| **Commenter** | External collaborators | View data and add comments |
| **Viewer** | Stakeholders | Read-only access for reports/dashboards |

### Webhooks Setup (Optional)

**Example: Slack Notification for New Customer**

1. Get Slack webhook URL:
   - Go to https://api.slack.com/apps
   - Create incoming webhook
   - Copy webhook URL

2. In RoboTable:
   - Open Customers table
   - Click gear icon → **Webhooks**
   - Add webhook:
     - Name: "New Customer Slack Alert"
     - URL: [your Slack webhook URL]
     - Event: After Insert
     - Active: Yes

3. Test:
   - Create new customer
   - Check Slack for notification

**Time**: 1-2 hours

---

## Troubleshooting

### Issue: Can't access localhost:8080

**Solution**:
```bash
# Check Docker is running
docker ps

# Check if port is in use
netstat -ano | findstr :8080  # Windows
lsof -i :8080                 # Mac/Linux

# Use different port
# Edit docker-compose.yml: change "8080:8080" to "3000:8080"
```

### Issue: Database connection failed

**Check connection string format**:
```
✅ Correct: pg://db.abc.supabase.co:5432?u=postgres&p=pass&d=postgres
❌ Wrong:   postgresql://postgres:pass@db.abc.supabase.co:5432/postgres
```

**Verify Supabase**:
- Check password is correct
- Ensure database is running (not paused)
- Check firewall/network rules

### Issue: Lost data after restart

**Solution**: Ensure volume is mounted

Check `docker-compose.yml`:
```yaml
volumes:
  - robotable-data:/usr/app/data
```

Verify volume exists:
```bash
docker volume ls | grep robotable
```

### Issue: Render deployment failed

**Check logs**:
1. Render dashboard → Your service → Logs
2. Look for specific error messages

**Common issues**:
- Missing environment variables
- Invalid `NC_DB` connection string
- Port mismatch (must be 8080)

### Issue: Slow performance

**Optimize database**:
1. Add indexes on frequently queried columns
2. Check Supabase dashboard for slow queries
3. Enable connection pooling (default: enabled)

**Upgrade hosting**:
- Render Standard plan: $25/month (500+ users)
- Enable auto-scaling

### Issue: Can't invite users (email not sending)

**Workaround**:
1. Share Render URL with team
2. Have them create accounts directly
3. You assign roles after they sign up

**Long-term solution**:
- Configure SMTP settings in environment variables
- Use SendGrid, Mailgun, or similar

---

## Backup Strategy

### Automatic Backups

**Supabase**: Automatic daily backups (7-day retention)
- Restore from Supabase dashboard if needed

### Manual Metadata Backup

Backup NocoDB configuration monthly:

```bash
# Export Docker volume
docker run --rm \
  -v robotable-data:/data \
  -v $(pwd)/backup:/backup \
  alpine tar czf /backup/robotable-$(date +%Y%m%d).tar.gz -C /data .
```

### Restore Procedure

1. Create new Docker volume
2. Extract backup:
   ```bash
   docker run --rm \
     -v robotable-data:/data \
     -v $(pwd)/backup:/backup \
     alpine tar xzf /backup/robotable-20260106.tar.gz -C /data
   ```
3. Start RoboTable with restored volume

**Test restore procedure quarterly**

---

## Performance Optimization

### Database Indexes

Add indexes for frequently queried columns:

1. Open Supabase Dashboard
2. Go to **Table Editor** → Select table
3. Add index on commonly filtered/sorted columns

Example:
```sql
CREATE INDEX idx_customers_status ON customers(status);
CREATE INDEX idx_tasks_assignee ON tasks(assignee);
```

### Monitoring

**Supabase**:
- Dashboard → Database → Query Performance
- Watch for slow queries (>500ms)

**Render**:
- Dashboard → Metrics
- Monitor CPU, memory, response times

### Scaling Plan

| Users | Render Plan | Cost | Notes |
|-------|-------------|------|-------|
| 1-100 | Starter | $7/mo | Good for most teams |
| 100-500 | Standard | $25/mo | Auto-scaling enabled |
| 500+ | Pro | Custom | Contact Render support |

Supabase scales automatically - no action needed.

---

## Security Checklist

- [ ] Strong JWT secret (32+ characters)
- [ ] HTTPS enabled (automatic on Render)
- [ ] Environment variables not in git
- [ ] Database password secure
- [ ] Regular updates (pull latest NocoDB image monthly)
- [ ] User permissions configured appropriately
- [ ] Backup/restore tested

---

## Next Steps

1. ✅ Complete local testing
2. ✅ Integrate with Supabase
3. ✅ Deploy to Render
4. ✅ Invite team and set up workspaces
5. ✅ Configure webhooks and automations
6. ✅ Monitor and optimize

**Need help?** Check [user-guide.md](./user-guide.md) or [api-guide.md](./api-guide.md)

---

*Last updated: 2026-01-06*
